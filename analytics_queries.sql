BEGIN TRANSACTION;
CREATE TABLE IF NOT EXISTS "dim_customer" (
	"customer_key"	INTEGER,
	"customer_id"	TEXT,
	"customer_name"	TEXT,
	"city"	TEXT,
	"state"	TEXT,
	"customer_segment"	TEXT,
	PRIMARY KEY("customer_key" AUTOINCREMENT)
);
CREATE TABLE IF NOT EXISTS "dim_date" (
	"date_key"	INTEGER,
	"full_date"	TEXT NOT NULL,
	"day_of_week"	TEXT,
	"day_of_month"	INTEGER,
	"month"	INTEGER,
	"month_name"	TEXT,
	"quarter"	TEXT,
	"year"	INTEGER,
	"is_weekend"	INTEGER,
	PRIMARY KEY("date_key")
);
CREATE TABLE IF NOT EXISTS "dim_product" (
	"product_key"	INTEGER,
	"product_id"	TEXT,
	"product_name"	TEXT,
	"category"	TEXT,
	"subcategory"	TEXT,
	"unit_price"	REAL,
	PRIMARY KEY("product_key" AUTOINCREMENT)
);
CREATE TABLE IF NOT EXISTS "fact_sales" (
	"sale_key"	INTEGER,
	"date_key"	INTEGER NOT NULL,
	"product_key"	INTEGER NOT NULL,
	"customer_key"	INTEGER NOT NULL,
	"quantity_sold"	INTEGER NOT NULL,
	"unit_price"	REAL NOT NULL,
	"discount_amount"	REAL DEFAULT 0,
	"total_amount"	REAL NOT NULL,
	PRIMARY KEY("sale_key" AUTOINCREMENT),
	FOREIGN KEY("customer_key") REFERENCES "dim_customer"("customer_key"),
	FOREIGN KEY("date_key") REFERENCES "dim_date"("date_key"),
	FOREIGN KEY("product_key") REFERENCES "dim_product"("product_key")
);
INSERT INTO "dim_customer" ("customer_key","customer_id","customer_name","city","state","customer_segment") VALUES (1,'C001','John Doe','Mumbai','Maharashtra','Retail'),
 (2,'C002','Amit Sharma','Delhi','Delhi','Retail'),
 (3,'C003','Priya Singh','Bangalore','Karnataka','Corporate'),
 (4,'C004','Neha Verma','Chennai','Tamil Nadu','Retail'),
 (5,'C005','Rohit Mehta','Mumbai','Maharashtra','Corporate'),
 (6,'C006','Anjali Rao','Bangalore','Karnataka','Retail'),
 (7,'C007','Vikas Gupta','Delhi','Delhi','Corporate'),
 (8,'C008','Sneha Iyer','Chennai','Tamil Nadu','Retail'),
 (9,'C009','Rahul Jain','Mumbai','Maharashtra','Retail'),
 (10,'C010','Kiran Patel','Bangalore','Karnataka','Corporate'),
 (11,'C011','Pooja Nair','Chennai','Tamil Nadu','Retail'),
 (12,'C012','Manish Khanna','Delhi','Delhi','Retail');
INSERT INTO "dim_date" ("date_key","full_date","day_of_week","day_of_month","month","month_name","quarter","year","is_weekend") VALUES (20240101,'2024-01-01','Monday',1,1,'January','Q1',2024,0),
 (20240102,'2024-01-02','Tuesday',2,1,'January','Q1',2024,0),
 (20240103,'2024-01-03','Wednesday',3,1,'January','Q1',2024,0),
 (20240104,'2024-01-04','Thursday',4,1,'January','Q1',2024,0),
 (20240105,'2024-01-05','Friday',5,1,'January','Q1',2024,0),
 (20240106,'2024-01-06','Saturday',6,1,'January','Q1',2024,1),
 (20240107,'2024-01-07','Sunday',7,1,'January','Q1',2024,1),
 (20240108,'2024-01-08','Monday',8,1,'January','Q1',2024,0),
 (20240109,'2024-01-09','Tuesday',9,1,'January','Q1',2024,0),
 (20240110,'2024-01-10','Wednesday',10,1,'January','Q1',2024,0),
 (20240201,'2024-02-01','Thursday',1,2,'February','Q1',2024,0),
 (20240202,'2024-02-02','Friday',2,2,'February','Q1',2024,0),
 (20240203,'2024-02-03','Saturday',3,2,'February','Q1',2024,1),
 (20240204,'2024-02-04','Sunday',4,2,'February','Q1',2024,1),
 (20240205,'2024-02-05','Monday',5,2,'February','Q1',2024,0),
 (20240206,'2024-02-06','Tuesday',6,2,'February','Q1',2024,0),
 (20240207,'2024-02-07','Wednesday',7,2,'February','Q1',2024,0),
 (20240208,'2024-02-08','Thursday',8,2,'February','Q1',2024,0),
 (20240209,'2024-02-09','Friday',9,2,'February','Q1',2024,0),
 (20240210,'2024-02-10','Saturday',10,2,'February','Q1',2024,1),
 (20240211,'2024-02-11','Sunday',11,2,'February','Q1',2024,1),
 (20240212,'2024-02-12','Monday',12,2,'February','Q1',2024,0),
 (20240213,'2024-02-13','Tuesday',13,2,'February','Q1',2024,0),
 (20240214,'2024-02-14','Wednesday',14,2,'February','Q1',2024,0),
 (20240215,'2024-02-15','Thursday',15,2,'February','Q1',2024,0),
 (20240216,'2024-02-16','Friday',16,2,'February','Q1',2024,0),
 (20240217,'2024-02-17','Saturday',17,2,'February','Q1',2024,1),
 (20240218,'2024-02-18','Sunday',18,2,'February','Q1',2024,1),
 (20240219,'2024-02-19','Monday',19,2,'February','Q1',2024,0),
 (20240220,'2024-02-20','Tuesday',20,2,'February','Q1',2024,0);
INSERT INTO "dim_product" ("product_key","product_id","product_name","category","subcategory","unit_price") VALUES (1,'P001','Laptop','Electronics','Computers',65000.0),
 (2,'P002','Smartphone','Electronics','Mobile',35000.0),
 (3,'P003','Headphones','Electronics','Audio',2500.0),
 (4,'P004','Television','Electronics','Home Entertainment',55000.0),
 (5,'P005','Keyboard','Electronics','Accessories',1200.0),
 (6,'P006','Office Chair','Furniture','Seating',9000.0),
 (7,'P007','Dining Table','Furniture','Table',25000.0),
 (8,'P008','Sofa','Furniture','Living Room',45000.0),
 (9,'P009','Bookshelf','Furniture','Storage',7000.0),
 (10,'P010','Bed','Furniture','Bedroom',60000.0),
 (11,'P011','Notebook','Stationery','Paper',100.0),
 (12,'P012','Pen Set','Stationery','Writing',350.0),
 (13,'P013','Backpack','Stationery','Bags',2200.0),
 (14,'P014','Calculator','Stationery','Electronics',1500.0),
 (15,'P015','Office File','Stationery','Storage',300.0);
INSERT INTO "fact_sales" ("sale_key","date_key","product_key","customer_key","quantity_sold","unit_price","discount_amount","total_amount") VALUES (1,20240106,1,1,2,65000.0,5000.0,125000.0),
 (2,20240107,2,2,1,35000.0,2000.0,33000.0),
 (3,20240106,3,3,3,2500.0,0.0,7500.0),
 (4,20240107,4,4,1,55000.0,3000.0,52000.0),
 (5,20240106,5,5,4,1200.0,0.0,4800.0),
 (6,20240203,6,6,1,9000.0,500.0,8500.0),
 (7,20240204,7,7,1,25000.0,2000.0,23000.0),
 (8,20240203,8,8,1,45000.0,5000.0,40000.0),
 (9,20240204,9,9,2,7000.0,0.0,14000.0),
 (10,20240203,10,10,1,60000.0,5000.0,55000.0),
 (11,20240210,11,11,10,100.0,0.0,1000.0),
 (12,20240211,12,12,5,350.0,0.0,1750.0),
 (13,20240210,13,1,2,2200.0,200.0,4200.0),
 (14,20240211,14,2,1,1500.0,0.0,1500.0),
 (15,20240210,15,3,6,300.0,0.0,1800.0),
 (16,20240108,1,4,1,65000.0,3000.0,62000.0),
 (17,20240109,2,5,2,35000.0,4000.0,66000.0),
 (18,20240110,3,6,2,2500.0,0.0,5000.0),
 (19,20240108,4,7,1,55000.0,2000.0,53000.0),
 (20,20240109,5,8,3,1200.0,0.0,3600.0),
 (21,20240215,6,9,1,9000.0,0.0,9000.0),
 (22,20240216,7,10,1,25000.0,1500.0,23500.0),
 (23,20240217,8,11,1,45000.0,3000.0,42000.0),
 (24,20240218,9,12,2,7000.0,0.0,14000.0),
 (25,20240217,10,1,1,60000.0,4000.0,56000.0),
 (26,20240219,11,2,8,100.0,0.0,800.0),
 (27,20240220,12,3,4,350.0,0.0,1400.0),
 (28,20240219,13,4,1,2200.0,0.0,2200.0),
 (29,20240220,14,5,1,1500.0,0.0,1500.0),
 (30,20240219,15,6,5,300.0,0.0,1500.0),
 (31,20240105,1,7,1,65000.0,2000.0,63000.0),
 (32,20240106,2,8,1,35000.0,1000.0,34000.0),
 (33,20240107,3,9,2,2500.0,0.0,5000.0),
 (34,20240106,4,10,1,55000.0,2500.0,52500.0),
 (35,20240107,5,11,3,1200.0,0.0,3600.0);
COMMIT;
